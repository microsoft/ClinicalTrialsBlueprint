{
 "name": "clinical_trials_matching_hds_async",
 "id": "dcd98db1-696d-47d6-a38e-f60d21fde914",
 "scenario_trigger": "HDSDataConnectionAsync",
 "description": "call HDS async Data Connection",
 "active": true,
 "updated": "2023-04-18T08:00:17.370Z",
 "userDisplayName": "Yochai Lehman",
 "code": "{\"version\":3,\"steps\":[{\"id\":\"7d13692c028c-c62feba5d349bb6e-7959\",\"type\":\"action\",\"label\":\"Init\",\"designer\":{\"xLocation\":250,\"yLocation\":0,\"next\":\"95f6b5f256da-ed1cea46c0187621-f7b9\"},\"onInit\":\"scenario.hdsRequest = scenario.scenarioArgs.hdsRequest;\\r\\n\"},{\"id\":\"95f6b5f256da-ed1cea46c0187621-f7b9\",\"type\":\"datasource\",\"designer\":{\"xLocation\":242,\"yLocation\":113,\"reverse\":true,\"next\":\"c50052217811-29d485f1b59b412b-8026\",\"errorStepId\":\"b06934c57c28-f7976d41b9a5e831-ef13\"},\"dataConnection\":\"healthinsight-async\",\"urlBase\":\"'https://tm-cs-hi-eastus.cognitiveservices.azure.com/'\",\"urlPath\":\"'healthinsights/trialmatcher/jobs'\",\"urlParams\":\"getEnv(\\\"hds-version\\\")\",\"contentType\":\"raw\",\"method\":\"post\",\"payload\":\"scenario.hdsRequest\",\"opJson\":true,\"opResolveWithFullResponse\":true,\"response\":\"hdsResponse\",\"error\":\"hdsError\",\"label\":\"HDS Matcher Enpoint #1\"},{\"id\":\"b06934c57c28-f7976d41b9a5e831-ef13\",\"type\":\"action\",\"label\":\"Set Error\",\"designer\":{\"xLocation\":518,\"yLocation\":284,\"next\":\"6bb6288ac74c-4e1587e6ee32388c-d52c\"},\"onInit\":\"scenario.error = customLocalizedStrings[\\\"CTM/messages/serviceProblem\\\"]\"},{\"id\":\"a1abaeda6f9e-b3eb89df49f71e4c-1e34\",\"type\":\"datasource\",\"designer\":{\"xLocation\":24,\"yLocation\":180,\"next\":\"e6c72ef1282a-0b5730b1bd9e0861-c99c\",\"errorStepId\":\"b06934c57c28-f7976d41b9a5e831-ef13\"},\"dataConnection\":\"\",\"urlBase\":\"scenario.hdsResponse.headers[\\\"operation-location\\\"]\",\"urlPath\":\"\",\"urlParams\":\"\",\"method\":\"get\",\"headers\":\"{\\\"Ocp-Apim-Subscription-Key\\\":getEnv(\\\"ocp-key\\\")}\",\"opJson\":true,\"opResolveWithFullResponse\":false,\"response\":\"asyncRes\",\"error\":\"hdsError\"},{\"id\":\"e6c72ef1282a-0b5730b1bd9e0861-c99c\",\"type\":\"branch\",\"condition\":\"scenario.retry < 5 && scenario.asyncRes.status !== \\\"succeeded\\\"\",\"designer\":{\"xLocation\":0,\"yLocation\":420,\"next\":\"6bb6288ac74c-4e1587e6ee32388c-d52c\"},\"targetStepId\":\"6cba4d65f563-345555b56df0c08b-9d85\"},{\"id\":\"6cba4d65f563-345555b56df0c08b-9d85\",\"label\":\"Wait\",\"type\":\"wait\",\"designer\":{\"xLocation\":290,\"yLocation\":473,\"next\":\"18cce553aa99-d7cd9893d104a1db-659d\"},\"time\":\"1000\"},{\"id\":\"c50052217811-29d485f1b59b412b-8026\",\"type\":\"assignVariable\",\"designer\":{\"xLocation\":98,\"yLocation\":326,\"next\":\"a1abaeda6f9e-b3eb89df49f71e4c-1e34\"},\"scope\":\"scenario\",\"operation\":\"set\",\"variable\":\"retry\",\"value\":\"0\"},{\"id\":\"18cce553aa99-d7cd9893d104a1db-659d\",\"type\":\"assignVariable\",\"designer\":{\"xLocation\":260,\"yLocation\":313,\"next\":\"a1abaeda6f9e-b3eb89df49f71e4c-1e34\"},\"scope\":\"scenario\",\"operation\":\"set\",\"variable\":\"retry\",\"value\":\"scenario.retry++;\"},{\"id\":\"6bb6288ac74c-4e1587e6ee32388c-d52c\",\"type\":\"endwithresult\",\"designer\":{\"xLocation\":280,\"yLocation\":664},\"endScope\":\"scenario\",\"label\":\"Scenario Result\",\"returnValue\":\"{\\r\\n\\\"response\\\":scenario.asyncRes,\\r\\n\\\"error\\\": scenario.error\\r\\n}\"}],\"breaking\":false,\"interrupting\":false,\"returningMessage\":\"\"}"
}